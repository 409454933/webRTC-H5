webpackJsonp([1],{"28yK":function(e,t){},OwUT:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{videoObj:null,streamer:null,microPhone:"",microPhoneList:[],camera:"",cameraList:[]}},created:function(){},mounted:function(){this.init()},methods:{showList:function(){var e=this;navigator.mediaDevices.enumerateDevices().then(function(t){e.microPhoneList=[],e.cameraList=[];for(var o=0;o!==t.length;++o){var i=t[o],a={};a.id=i.deviceId,"audioinput"===i.kind?(a.label=i.label||"microphone "+(audioSelect.length+1),e.microPhoneList.push(a)):"videoinput"===i.kind?(a.label=i.label||"camera "+(videoSelect.length+1),e.cameraList.push(a)):console.log("Found one other kind of source/device: ",i)}}).then(function(){e.removeEvent(e.$refs.microPhone,"change",e.videoStart),e.addEvent(e.$refs.microPhone,"change",e.videoStart),e.removeEvent(e.$refs.camera,"change",e.videoStart),e.addEvent(e.$refs.camera,"change",e.videoStart)}).catch(function(e){console.log(e)})},init:function(){videojs(document.querySelector(".video-js"),{controls:!0,autoplay:!0,preload:"auto"}),this.videoObj=this.$refs.videoplay,this.showList(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,this.videoStart()},videoStart:function(){var e={};this.microPhone?e.audio={deviceId:{exact:this.microPhone}}:e.audio=!1,this.camera?e.video={deviceId:{exact:this.camera}}:e.video=!1,this.camera||this.microPhone?navigator.getUserMedia(e,this.videoSuccess,this.videoError):this.$message({message:"摄像头和麦克风必须开启一个才能直播",type:"warning"})},closeMicroPhone:function(){this.microPhone="",this.videoStart()},closeCamera:function(){this.camera="",this.videoStart()},videoSuccess:function(e){this.streamer="function"==typeof e.stop?e:e.getTracks()[0];try{this.videoObj.src=window.URL.createObjectURL(e)}catch(t){this.videoObj.srcObject=e}},videoError:function(e){this.error("直播间需浏览器享有“摄像头/相机、麦克风权限”")},error:function(e){this.$message({message:e,type:"warning"})}}},a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"video-page"},[o("el-row",[o("el-col",{attrs:{xs:24}},[o("video",{ref:"videoplay",staticClass:"video-js",attrs:{poster:"",preload:"auto",autoplay:""}}),e._v(" "),o("button",{on:{click:e.showList}},[e._v("查看摄像头和麦克风")]),e._v(" "),o("select",{directives:[{name:"model",rawName:"v-model",value:e.microPhone,expression:"microPhone"}],ref:"microPhone",attrs:{name:"microPhone"},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.microPhone=t.target.multiple?o:o[0]}}},[o("option",{attrs:{value:"",disabled:"",selected:""}},[e._v("请选择麦克风")]),e._v(" "),e._l(e.microPhoneList,function(t,i){return o("option",{key:i,domProps:{value:t.id}},[e._v(e._s(t.label))])})],2),e._v(" "),o("select",{directives:[{name:"model",rawName:"v-model",value:e.camera,expression:"camera"}],ref:"camera",attrs:{name:"camera"},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.camera=t.target.multiple?o:o[0]}}},[o("option",{attrs:{value:"",disabled:"",selected:""}},[e._v("请选择摄像头")]),e._v(" "),e._l(e.cameraList,function(t,i){return o("option",{key:i,domProps:{value:t.id}},[e._v(e._s(t.label))])})],2)])],1),e._v(" "),o("el-row",[o("el-col",{attrs:{xs:24}},[o("button",{on:{click:e.closeCamera}},[e._v("关闭摄像头")]),e._v(" "),o("button",{on:{click:e.closeMicroPhone}},[e._v("关闭麦克风")])])],1)],1)},staticRenderFns:[]};var r=o("VU/8")(i,a,!1,function(e){o("28yK")},"data-v-b9147c38",null);t.default=r.exports}});